---
name: equivalence-partitioning
description: 同値分割法を適用し、入力ドメインを有効・無効の同値クラスに分割してテストケースを導出する。
trigger: 入力ドメインが定義されており、値の範囲やカテゴリが識別可能な場合
---

# Equivalence Partitioning

- Purpose: 同値分割法によるテストケース導出
- Scope: 単一テスト技法の適用

## 実行手順

1. **入力パラメータの特定**
   - テスト対象の機能から全入力パラメータを列挙する
   - 各パラメータのデータ型、制約条件、仕様上の定義を確認する

2. **各パラメータの有効同値クラスと無効同値クラスの識別**
   - 仕様に基づき、正常に処理される値の集合（有効クラス）を定義する
   - 仕様外やエラーとなる値の集合（無効クラス）を定義する
   - 各クラスに一意のIDを付与する（例: EP-V1, EP-I1）

3. **同値クラスごとの代表値の選択**
   - 各同値クラスから1つ以上の代表値を選択する
   - クラス内のどの値を選んでも同じ振る舞いとなることを確認する

4. **有効クラスの組合せテストケース作成**
   - 複数パラメータの有効クラスを組み合わせたテストケースを作成する
   - 可能な限り1つのテストケースで複数の有効クラスをカバーする

5. **無効クラスの単一テストケース作成（1つずつ無効にする）**
   - 無効クラスのテストケースでは、1つのパラメータのみ無効値とし、残りは有効値とする
   - これにより、どのパラメータが原因でエラーが発生したかを特定可能にする

## 出力形式

```json
{
  "technique": "equivalence_partitioning",
  "requirement_id": "REQ-XXX",
  "test_cases": [
    {
      "id": "TC-EP-001",
      "title": "テストケースのタイトル",
      "preconditions": ["前提条件"],
      "test_data": {
        "input": {"param1": "代表値1", "param2": "代表値2"},
        "partitions": {"param1": "EP-V1", "param2": "EP-V2"}
      },
      "steps": ["手順1", "手順2"],
      "expected_result": "期待結果",
      "priority": "high|medium|low",
      "traceability": {
        "requirement_id": "REQ-XXX",
        "technique": "equivalence_partitioning",
        "rationale": "導出根拠"
      }
    }
  ],
  "coverage_analysis": {
    "identified": 0,
    "covered": 0,
    "percentage": 100
  }
}
```

## 自己修正

- **同値クラスの分割が不明確**: 仕様を再読み込みし、境界条件を手がかりにクラスを再定義する
- **有効/無効の判断が困難**: ユーザーに仕様の確認を求める
- **クラス数が過多**: 類似クラスの統合を検討し、代表性を再評価する
- **クラス数が過少**: 隠れた条件分岐がないか仕様を再確認する

## 参照

詳細基準: `references/technique_guide.md`
