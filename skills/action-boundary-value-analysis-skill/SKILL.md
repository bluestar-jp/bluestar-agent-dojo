---
name: boundary-value-analysis
description: 境界値分析を適用し、同値クラスの境界上および境界近傍の値でテストケースを導出する。
trigger: 数値的な境界（最小値、最大値）が存在する入力パラメータがある場合
---

# Boundary Value Analysis

- Purpose: 境界値分析によるテストケース導出
- Scope: 単一テスト技法の適用

## 実行手順

1. **同値クラスの境界値の特定**
   - 各同値クラスの上限値と下限値を特定する
   - 境界が包含（<=）か排他（<）かを仕様から確認する
   - 各境界に一意のIDを付与する（例: BV-1, BV-2）

2. **2値境界テスト（境界値、境界値±1）**
   - 各境界について、境界値そのものと隣接する値の2つをテスト値とする
   - 下限境界: 境界値、境界値-1
   - 上限境界: 境界値、境界値+1

3. **必要に応じて3値境界テスト**
   - 高リスクな境界では、境界値-1、境界値、境界値+1の3つをテスト値とする
   - 3値テストが必要な場面: 金融計算、安全性に関わる処理、過去にバグが多発した箇所

4. **複数パラメータの境界値組合せ**
   - 1つのパラメータを境界値とし、他のパラメータは公称値（中央付近の有効値）とする
   - 全パラメータを同時に境界値にする組合せは、リスクベースで判断する

5. **テストケースの作成**
   - 各境界値テストに対して期待結果を定義する
   - 境界の内側（有効）と外側（無効）で期待結果が異なることを確認する

## 出力形式

```json
{
  "technique": "boundary_value_analysis",
  "requirement_id": "REQ-XXX",
  "test_cases": [
    {
      "id": "TC-BVA-001",
      "title": "テストケースのタイトル",
      "preconditions": ["前提条件"],
      "test_data": {
        "input": {"param1": "境界値", "param2": "公称値"},
        "boundary": "BV-1",
        "boundary_type": "2-value|3-value"
      },
      "steps": ["手順1", "手順2"],
      "expected_result": "期待結果",
      "priority": "high|medium|low",
      "traceability": {
        "requirement_id": "REQ-XXX",
        "technique": "boundary_value_analysis",
        "rationale": "導出根拠"
      }
    }
  ],
  "coverage_analysis": {
    "identified": 0,
    "covered": 0,
    "percentage": 100
  }
}
```

## 自己修正

- **境界が不明確**: 仕様を再確認し、包含/排他の区別をユーザーに問い合わせる
- **非数値の境界**: 文字列長、配列サイズなど数値に変換可能な属性を特定する
- **境界値が多すぎる**: リスクベースで優先順位を付け、高リスク境界から実施する
- **同値分割が未実施**: 先に同値分割を行い、クラスの境界を明確にしてから再実行する

## 参照

詳細基準: `references/technique_guide.md`
