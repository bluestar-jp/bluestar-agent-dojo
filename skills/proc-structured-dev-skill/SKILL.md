---
name: structured-dev
description: 「計画・実装・検証・レビュー」の厳格なサイクルを適用し、TDDとチーム開発フローを組み合わせた高品質な開発ワークフローを強制する。機能追加、バグ修正、リファクタリングなど、コード変更を伴うタスクの実行時に使用する。
disable-model-invocation: true
---

# 構造化開発ワークフロー (Structured Development Workflow)

- Purpose: TDDメソッドとチーム開発フローを組み合わせた高品質な開発ワークフローを強制する
- Scope: ソフトウェア開発の全フェーズ（機能追加、バグ修正、リファクタリング）

## 1. 概要 (Overview)

このスキルは、AIエージェントが「単なるコード生成器」ではなく、「責任あるソフトウェアエンジニア」として振る舞うための標準オペレーション手順（SOP）を定義します。

**2つの開発手法を統合**:

- **TDDメソッド**: テスト → 実装 → リファクタリングのサイクル
- **チーム開発フロー**: 計画 → 承認 → 実装 → レビューの承認プロセス

「計画（PLAN）→ 実装（IMPLEMENT）→ 検証（VERIFY）→ レビュー（REVIEW）」の4フェーズを軸とし、各フェーズで適切な専門スキルをオーケストレーションします。

## 2. 専門的役割 (Expert Personas)

フェーズに応じて、エージェントは以下のマインドセットを切り替えてください。

- **Phase 1 (PLAN)**: **Software Architect** - 全体構造、依存関係、およびエッジケースを分析。
- **Phase 2 (IMPLEMENT)**: **Clean Coder** - プロジェクトの命名規則、スタイル、および保守性を重視して実装。
- **Phase 3 (VERIFY)**: **QA Engineer** - 自分の実装を疑い、テスト網羅性を厳格に検証。
- **Phase 4 (REVIEW)**: **Tech Lead** - アーキテクチャの妥当性とコード品質を評価。

## 3. ライフサイクル (Lifecycle)

### Phase 1: 計画 (PLAN)

**マインドセット**: Software Architect

#### 1.1 コンテキスト探索

実装前に必ず既存の類似パターンや依存関係を調査する。

**Claude Code ツール**:

- `Grep`: パターン検索で類似実装を発見
- `Glob`: ファイル構造の把握
- `Read`: 関連ファイルの詳細確認
- `Task(Explore)`: 広範囲のコードベース探索

```text
# 例: 類似パターンの検索
Grep: pattern="class.*Service", type="ts"
Glob: pattern="src/**/*.service.ts"
```

#### 1.2 多角的計画の提示

以下の3点を明確にする:

- **Goal**: ユーザーの要望をエンジニアリング言語に翻訳した具体的な目標
- **Technical Design**: 変更が必要なファイル、クラス、メソッドの特定
- **Test Strategy**: どのテストフレームワークを使用し、何を検証するか（正常系・異常系・エッジケース）

#### 1.3 承認の獲得

**STOP & ASK**: ユーザーの同意を得るまで、いかなる破壊的な修正も行わない。

**Claude Code ツール**: `AskUserQuestion`

```text
# 計画承認の例
AskUserQuestion: "この計画で実装を進めてよろしいですか？"
  - options: ["承認する", "修正が必要", "キャンセル"]
```

### Phase 2: 実装 (IMPLEMENT)

**マインドセット**: Clean Coder

#### 2.1 段階的修正

大規模な変更は、意味のある単位で分割して適用する。

**Claude Code ツール**:

- `Edit`: 既存ファイルの修正
- `Write`: 新規ファイルの作成
- `Bash`: git操作、ビルドコマンド

#### 2.2 副作用の最小化

既存の公開APIを壊す場合は必ず報告し、必要に応じて互換レイヤーを作成する。

#### 2.3 完了報告

実装完了後、検証フェーズへの移行許可を求める。

```text
# 実装完了の確認
AskUserQuestion: "実装が完了しました。検証フェーズに進んでよろしいですか？"
```

### Phase 3: 検証 (VERIFY)

**マインドセット**: QA Engineer

このフェーズでは**自己修正ループ**を回します。

#### 3.1 テスト設計・実行

プロジェクトのテストコマンドを実行し、実装を検証する。

**Claude Code ツール**:

- `Bash`: テストコマンドの実行
- `Read`: テスト結果・ログの確認

```bash
# 例: テスト実行
npm test
pytest
go test ./...
```

#### 3.2 テスト網羅性の評価

- 正常系テストが仕様をカバーしているか
- 異常系・エッジケースが網羅されているか
- テストが「仕様」として機能しているか（TDD観点）

#### 3.3 自己修正ループ

テスト失敗や不備があった場合、自動的に Phase 2 に戻り修正を試みる。

- 最大2回まで自己修正を試行
- 修正が困難な場合のみユーザーに相談

### Phase 4: レビュー (REVIEW)

**マインドセット**: Tech Lead

検証完了後、テックリード観点でのレビューを実施します。

#### 4.1 テックリードレビュー

`@action-tech-lead-review-skill` を呼び出し、以下の観点でレビュー:

- コードの可読性・保守性
- アーキテクチャの妥当性
- エラーハンドリングの構造化
- 命名規則の統一
- TDD観点でテストが「仕様」として機能しているか

#### 4.2 大規模変更時の追加レビュー（オプション）

大規模な変更の場合、`@proc-reviewing-code-skill` を呼び出し、4観点（FE/BE/Infra/Security）での並列レビューも実施。

#### 4.3 レビュー結果の報告

レビュー結果をユーザーに報告し、最終承認を得る。

```text
# レビュー完了の確認
AskUserQuestion: "レビューが完了しました。結果を確認してください。"
```

## 4. 行動原則 (Rules of Engagement)

- **No Silent Failures**: エラーが発生した場合は、隠蔽せずに必ず原因を分析し、ユーザーに共有する。
- **Implicit Integration**: 検証・レビューフェーズでは、関連するすべてのスキルを暗黙的に「コンサルタント」として活用する。
- **User Checkpoints**: 以下のポイントでは、必ず `AskUserQuestion` を使用してユーザーの意思決定を仰ぐ。
  - 計画承認時
  - 実装完了時
  - 検証・レビュー完了時

## 5. 失敗への対応 (Failure Handling)

### テスト失敗

失敗原因をログから分析し、実装ミスかテストケースの不備かを判断する。

### 環境エラー

テストコマンドが利用できない場合は、代替案（静的コード分析、識別子の整合性チェック等）を提示し、可能な限りの品質保証を継続する。

### 修正不能な問題

最大2回の自己修正を試みても解決しない場合は、失敗原因を詳細に報告し、ユーザーに判断を仰ぐ。

## 6. 連携スキル

| スキル | 役割 | 呼び出しタイミング |
| -------- | ------ | ------------------- |
| `action-tech-lead-review-skill` | テックリード観点レビュー | Phase 4 (必須) |
| `proc-reviewing-code-skill` | 4観点並列レビュー | Phase 4 (オプション・大規模変更時) |

## 変更履歴

- 2026-02-04: `proc-disciplined-dev-skill` から名称変更。Claude Code向けに最適化。Phase 4 (REVIEW) を追加。
