---
name: decision-table-testing
description: ディシジョンテーブルテストを適用し、複数条件の組合せとその結果アクションを体系的にテストケースとして導出する。
trigger: 2つ以上の条件の組合せによって異なるアクションが実行される場合
---

# Decision Table Testing

- Purpose: ディシジョンテーブルテストによるテストケース導出
- Scope: 単一テスト技法の適用

## 実行手順

1. **条件（入力）とアクション（出力）の列挙**
   - 仕様から全条件を抽出する（各条件はtrue/falseで表現可能なものとする）
   - 条件によって実行される全アクションを抽出する
   - 条件とアクションにそれぞれIDを付与する（例: C1, C2, A1, A2）

2. **完全ディシジョンテーブルの作成**
   - N個の条件に対して2^N個のルール（列）を作成する
   - 各ルールに対して条件の真偽の組合せを記入する
   - 各ルールに対して実行されるアクションを記入する

3. **矛盾・不可能な組合せの除外**
   - 論理的に矛盾する条件の組合せを特定する（例: 「年齢 < 18」かつ「退職済み」）
   - 物理的に不可能な組合せを特定する
   - 除外理由を記録する

4. **簡略化ルールの適用（同一アクションの統合）**
   - 同一のアクション結果を持つルールを統合する
   - 統合時にDon't Care条件（-）を使用する
   - 簡略化後もテストカバレッジが維持されることを確認する

5. **各ルールからテストケースの導出**
   - 各ルール（簡略化後）に対して1つ以上のテストケースを作成する
   - Don't Care条件には具体的なテスト値を割り当てる
   - 各テストケースの期待結果を明確に定義する

## 出力形式

```json
{
  "technique": "decision_table_testing",
  "requirement_id": "REQ-XXX",
  "test_cases": [
    {
      "id": "TC-DT-001",
      "title": "テストケースのタイトル",
      "preconditions": ["前提条件"],
      "test_data": {
        "input": {"param1": "具体的なテスト値"},
        "rule": "R1",
        "conditions": {"C1": true, "C2": false},
        "expected_actions": {"A1": true, "A2": false}
      },
      "steps": ["手順1", "手順2"],
      "expected_result": "期待結果",
      "priority": "high|medium|low",
      "traceability": {
        "requirement_id": "REQ-XXX",
        "technique": "decision_table_testing",
        "rationale": "導出根拠"
      }
    }
  ],
  "coverage_analysis": {
    "identified": 0,
    "covered": 0,
    "percentage": 100
  }
}
```

## 自己修正

- **条件数が多すぎる（>4）**: リスクベースで条件を優先順位付けし、重要な条件の組合せに絞る
- **アクションが不明確**: 仕様を再確認し、条件に対する振る舞いをユーザーに問い合わせる
- **矛盾の判断が困難**: 条件間の依存関係を図式化し、ドメインエキスパートに確認する
- **テーブルが仕様と不整合**: 仕様の条件分岐ロジックを再度トレースし、漏れを修正する

## 参照

詳細基準: `references/technique_guide.md`
