---
name: clarifying-requirements
description: システム要件のテスト可能性を分析し、曖昧な点を特定してユーザーとの対話で要件を明確化するワークフロー。テスト設計の前段階で要件の明確化が必要な場合に使用する。
disable-model-invocation: true
---

# Requirement Clarification Skill

- Purpose: システム要件のテスト可能性を分析し、曖昧な点を特定してユーザーとの対話で要件を明確化する
- Scope: テスト設計前の要件品質担保

## ワークフロー（PAVE）

### Phase 1: Plan（分析計画）

要件テキストを受け取り、以下の観点でテスト可能性を分析する:

1. **曖昧な用語の特定**: 「適切な」「速い」「大量の」等の定量化されていない表現
2. **未定義の境界**: 入力値の上限/下限が明示されていない
3. **エラーハンドリングの欠如**: 異常系の振る舞いが未定義
4. **入力形式の不明確さ**: データ型、フォーマット、文字コード等が未指定
5. **前提条件の欠如**: 実行に必要な事前状態が明示されていない

### Phase 2: Agree（ユーザーとの合意）

特定した問題点を構造化された質問として提示する:

```text
以下の要件について明確化が必要です:

1. [REQ-001] 「レスポンスが速い」の具体的な基準は？
   → 例: 95パーセンタイルで200ms以内
2. [REQ-002] 入力値の上限が未定義です。最大文字数は？
   → 例: 255文字
3. [REQ-003] 無効な入力時のエラーメッセージは定義されていますか？
```

### Phase 3: Execute（要件の構造化）

ユーザーの回答を統合し、構造化された要件仕様を作成する:

```json
{
  "requirements": [
    {
      "id": "REQ-001",
      "description": "明確化された要件記述",
      "input_domain": {
        "valid": ["有効な入力の定義"],
        "invalid": ["無効な入力の定義"]
      },
      "expected_behavior": {
        "normal": "正常時の期待動作",
        "error": "異常時の期待動作"
      },
      "constraints": ["制約条件"],
      "assumptions": ["前提条件"]
    }
  ]
}
```

### Phase 4: Verify（検証）

各要件が以下の基準を満たすか検証する:

- [ ] 測定可能な期待結果を持つか
- [ ] 入力ドメインが定義されているか
- [ ] 前提条件が明示されているか
- [ ] 境界値が特定可能か
- [ ] エラーハンドリングが定義されているか

## 出力形式

```json
{
  "clarification_result": {
    "original_requirements": "元の要件テキスト",
    "clarified_requirements": [],
    "unresolved_items": [],
    "testability_score": "high|medium|low"
  }
}
```

## 自己修正

- **ユーザーが回答を拒否した項目**: `unresolved_items`に記録し、前提を明示してテスト設計を続行
- **要件が大きすぎる**: 機能単位に分割を提案
- **矛盾する要件**: 矛盾点を提示し、ユーザーに優先順位の確認を依頼
