# Data Flow Testing Guide

- Purpose: データフローテストの詳細ガイド（ISTQB準拠）
- Scope: du-pair特定、カバレッジ基準、異常パターン検出

## 概要

データフローテストは、変数の定義（def）と使用（use）の関係を分析し、データに関連する欠陥を検出する構造ベースの技法である。

## 変数の定義と使用

### 定義（def）

変数に値が割り当てられる箇所:

- 代入文: `x = 10`
- パラメータ: `function f(x)`
- 入力: `x = read()`
- ループ変数: `for x in ...`

### 使用（use）

変数の値が参照される箇所:

- **c-use（計算使用）**: 演算や出力で参照: `y = x + 1`, `print(x)`
- **p-use（述語使用）**: 条件判定で参照: `if (x > 0)`

## 定義-使用ペア（du-pair）

- (d, u): 定義箇所dから使用箇所uへの定義クリアパスが存在
- 定義クリアパス: dからuに至るパスで、途中にxの再定義がない

## カバレッジ基準

| 基準 | 強度 | 説明 |
| --- | --- | --- |
| all-defs | 最低限 | 各定義が少なくとも1つの使用に到達 |
| all-c-uses | 中 | すべての計算使用ペアをカバー |
| all-p-uses | 中 | すべての述語使用ペアをカバー |
| all-uses | 推奨 | すべてのdu-pairをカバー |
| all-du-paths | 最強 | すべてのdu-pair間の全パスをカバー |

## 異常パターンの検出

### 定義-未使用（d-d）

- 変数が定義された後、使用されずに再定義される
- 潜在的バグ: 最初の定義が無意味

### 未定義-使用（u-d）

- 変数が定義される前に使用される
- 確実なバグ: 未初期化変数の参照

### 定義-消滅（d-k）

- 変数が定義された後、使用されずにスコープを出る
- 潜在的バグ: 計算結果の未使用

## 実用的なアプローチ

- 大規模コードでは全du-pairのテストは現実的でないことが多い
- all-defsカバレッジを最低限の基準とし、リスクの高い変数にall-usesを適用
- ツール支援（静的解析）を活用してdu-pairを自動抽出
