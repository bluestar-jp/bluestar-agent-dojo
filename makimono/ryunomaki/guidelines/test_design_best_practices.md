# Test Design Best Practices

- Purpose: テスト設計エコシステムにおけるベストプラクティスの定義
- Scope: 全エージェント・全スキルが参照する設計原則

## 基本原則

### 1. 要件トレーサビリティ

すべてのテストケースは1つ以上の要件にトレース可能でなければならない。

- 各テストケースの`traceability`フィールドに要件IDと導出根拠を記載する
- 要件IDが明示されていない場合は、要件明確化フェーズで付番する
- トレーサビリティマトリクスで要件の網羅性を確認する

### 2. テスト技法の適切な選択

要件の特性に応じて最適な技法を選択する。闇雲に全技法を適用しない。

- **入力ドメインが明確** → 同値分割法・境界値分析を優先
- **条件の組合せが複雑** → ディシジョンテーブル・ペアワイズを適用
- **状態遷移が存在** → 状態遷移テストを適用
- **コードが提供されている** → ホワイトボックス技法を追加適用
- **ドメイン固有リスクあり** → 経験ベース技法で補完

### 3. 重複排除

異なる技法から同一条件をテストするケースが導出されることがある。

- Level 2（Deshi）でカテゴリ内の重複を排除する
- Level 3（Shihan）でカテゴリ間の重複を排除する
- 排除時は`duplicate_removals`に記録し、トレーサビリティを維持する

### 4. 優先度付け

テストケースには優先度を付与し、実行順序の判断材料とする。

- **high**: 主要機能に直結、障害時の影響大、セキュリティ関連
- **medium**: 補助的機能、エッジケース、パフォーマンス関連
- **low**: UI/UXの微細な確認、推奨設定の検証

## 技法適用ガイドライン

### ブラックボックス技法

- **同値分割法**: 有効・無効の両方の同値クラスを識別する。有効クラスのみでは不十分
- **境界値分析**: 2値境界（on/off）を基本とし、要件に応じて3値（on/off/off-by-one）を適用
- **ディシジョンテーブル**: 条件数が多い場合は簡略化ルールを適用し、実用的なサイズに保つ
- **状態遷移テスト**: 不正遷移（無効イベント）のテストも含める
- **ユースケーステスト**: 正常フロー・代替フロー・例外フローを網羅する
- **ペアワイズテスト**: 3つ以上の独立パラメータがある場合に適用。2パラメータなら全組合せで十分

### ホワイトボックス技法

- **分岐網羅**: 最低限の基準として常に適用する
- **制御フロー**: ループ境界（0回、1回、N回、最大回数）をテストする
- **データフロー**: 定義-使用ペアを特定し、全ペアをカバーする

### 経験ベース技法

- **エラー推測**: 一般的な障害パターン（null、空文字、境界外、型不一致）を系統的に列挙する
- **探索的テスト**: チャーターを明確にし、時間制限を設ける
- **チェックリストベース**: ドメイン固有のチェックリストを活用する

## テストケース記述のベストプラクティス

### 明確な期待結果

- 「正しく動作する」ではなく「ステータスコード200を返し、レスポンスボディにユーザーIDを含む」のように具体的に記述
- 観測可能で検証可能な結果を記述する

### 再現可能なテストデータ

- テストデータは具体的な値を記載する
- 「有効な値」ではなく「年齢: 25」のように明示する
- 境界値は正確な数値を記載する

### 独立したテストケース

- 各テストケースは他のテストケースに依存しない
- 前提条件で必要な状態を明示する

## ISTQB準拠

本エコシステムのテスト技法はISTQB Foundation Level Syllabusに準拠する。各技法の詳細は各スキルの`references/technique_guide.md`を参照すること。
